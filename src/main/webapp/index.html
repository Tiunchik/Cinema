<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function loadPage() {
            $.ajax({
                url: getContextPath() + "/post",
                method: 'POST',
                contentType: 'json',
                data: JSON.stringify({'action': 'getHall'}),
                dataType: 'json'
            }).done(function (data) {
                $(data).each(function (index, element) {
                    var line = '<td> Row: ' + data[index][0].row + '</td>';
                    $(data[index]).each(function (ind, el) {
                        line = line + createCell(el.row, el.place, el.holder);
                    });
                    $('#table_body').append('<tr>' + line + '</tr>');
                });
                var line = '<th></th>';
                for (var i = 0; i < data[0].length; i++) {
                    line = line + '<th> Place: </th>';
                }
                $('#table_thead').append('<tr>' + line + '</tr>');
            })
        });

        setTimeout(function () {
            location.reload();
        }, 30000);

        function createCell(row, place, attr) {
            var out = '<td bgcolor="white" id="cell' + row + place + '">' + place + "  ";
            if (attr == 0) {
                out = out + '<input class="checkbox" type="checkbox" id="' + row + place + '" >';
            }
            out = out + '<input type="hidden" value="' + row + '" id="1attr' + row + place + '"></td>';
            out = out + '<input type="hidden" value="' + place + '" id="2attr' + row + place + '"></td>';
            return out;
        }

        function getContextPath() {
            return location.pathname.substring(0, window.location.pathname.indexOf("/", 2));
        }

        function getPaymentPage() {
            var line = "{\"check\":[";
            var number = 0;
            $('input:checkbox:checked').each(function (index, el) {
                line = line + "\"" + $('#1attr' + el.id).val() + "-" + $('#2attr' + el.id).val() + "\",";
                number++;
            });
            line = line.substring(0, line.length - 1) + "]";
            line = line + ",\"action\":\"payment\",";
            line = line + "\"number\":" + number + "}";
            localStorage.setItem('payment', line);
            location.href = getContextPath() + "/payment";
        }
    </script>
</head>
<body>
<div class="container">
    <h2>Main cinema hall</h2>
    <p>Please choose your sits</p>
    <table class="table table-bordered">
        <thead id="table_thead">
        </thead>
        <tbody id="table_body">
        </tbody>
    </table>
    <input type="button" value="Buy tickets" onclick="getPaymentPage()">
</div>
</body>
</html>